<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SRT Timecode Remover</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      margin: 0;
      padding: 16px;
      background: #0f172a;
      color: #e5e7eb;
    }

    h1 {
      font-size: 1.4rem;
      margin: 0 0 4px;
    }

    .subtitle {
      font-size: 0.9rem;
      color: #9ca3af;
      margin-bottom: 16px;
    }

    .container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    @media (max-width: 900px) {
      .container {
        grid-template-columns: 1fr;
      }
    }

    .panel {
      background: #020617;
      border-radius: 10px;
      padding: 10px;
      border: 1px solid #1f2937;
      display: flex;
      flex-direction: column;
      min-height: 260px;
    }

    .panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 6px;
    }

    .panel-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: #f9fafb;
    }

    .panel-subtitle {
      font-size: 0.75rem;
      color: #6b7280;
    }

    textarea {
      width: 100%;
      resize: both;          /* resizable both ways */
      max-width: 100%;       /* don't overflow panel horizontally */
      height: 260px;         /* initial size, user can drag */
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #1f2937;
      background: #020617;
      color: #e5e7eb;
      font-family: "SF Mono", Menlo, Monaco, Consolas, "Liberation Mono",
        "Courier New", monospace;
      font-size: 0.82rem;
      line-height: 1.4;
      outline: none;
    }

    textarea:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 1px #3b82f6;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 10px 0;
      align-items: center;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 7px 14px;
      font-size: 0.8rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      background: #1d4ed8;
      color: #f9fafb;
      transition: background 0.15s ease, transform 0.05s ease;
      white-space: nowrap;
    }

    button.secondary {
      background: #111827;
      color: #e5e7eb;
      border: 1px solid #374151;
    }

    button:disabled {
      opacity: 0.5;
      cursor: default;
      transform: none;
    }

    button:not(:disabled):hover {
      background: #2563eb;
      transform: translateY(-0.5px);
    }

    button.secondary:not(:disabled):hover {
      background: #1f2937;
    }

    input[type="file"] {
      font-size: 0.75rem;
      color: #9ca3af;
      max-width: 100%;
    }

    .footer {
      margin-top: 12px;
      font-size: 0.75rem;
      color: #6b7280;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      border-radius: 999px;
      padding: 2px 8px;
      background: #111827;
      color: #9ca3af;
      font-size: 0.7rem;
      gap: 4px;
      border: 1px solid #1f2937;
    }

    .badge input[type="file"] {
      border: none;
      background: transparent;
      padding: 0;
      margin-left: 4px;
    }

    .toggle-label {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.75rem;
      color: #e5e7eb;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #1f2937;
      background: #020617;
    }

    .toggle-label input {
      accent-color: #3b82f6;
    }

    .chip {
      font-size: 0.7rem;
      background: #111827;
      border-radius: 999px;
      padding: 2px 8px;
      margin-left: 4px;
      border: 1px solid #1f2937;
    }

    .status {
      font-size: 0.75rem;
      color: #9ca3af;
    }

    .status strong {
      color: #e5e7eb;
    }
  </style>
</head>
<body>
  <header>
    <h1>SRT Timecode Remover</h1>
    <div class="subtitle">
      Paste your <code>.srt</code> subtitles and get clean text without indices or
      timecodes ‚Äî perfect for full-text transcription.
    </div>
  </header>

  <div class="controls">
    <button id="convertBtn">
      ‚öôÔ∏è Strip timecodes
    </button>
    <button id="copyBtn" class="secondary" disabled>
      üìã Copy output
    </button>

    <label class="badge">
      üìÅ Load .srt
      <input type="file" id="fileInput" accept=".srt,text/plain" />
    </label>

    <!-- NEW: Merge to paragraph toggle -->
    <label class="toggle-label">
      <input type="checkbox" id="mergeToggle" />
      Merge into paragraphs
    </label>

    <span class="status" id="statusText"></span>
  </div>

  <div class="container">
    <section class="panel">
      <div class="panel-header">
        <div>
          <div class="panel-title">Input SRT</div>
          <div class="panel-subtitle">
            Paste raw <code>.srt</code> content here
            <span class="chip">keeps all dialogue lines</span>
          </div>
        </div>
      </div>
      <textarea
        id="inputSrt"
        placeholder="Paste your SRT file content here..."
      ></textarea>
    </section>

    <section class="panel">
      <div class="panel-header">
        <div>
          <div class="panel-title">Clean Transcript</div>
          <div class="panel-subtitle">
            Timecodes &amp; indices removed,
            <span id="modeHint">line breaks preserved</span>
          </div>
        </div>
      </div>
      <textarea
        id="outputText"
        placeholder="Your cleaned transcript will appear here..."
        readonly
      ></textarea>
    </section>
  </div>

  <div class="footer">
    ‚Ä¢ Removes lines like <code>1</code> and
    <code>00:00:01,000 --&gt; 00:00:04,000</code><br />
    ‚Ä¢ Optionally merge into paragraphs: blank lines become paragraph breaks, lines within each block are joined with spaces.
  </div>

  <script>
    function stripSrtTimecodes(srtText) {
      if (!srtText) return "";

      const lines = srtText.split(/\r?\n/);

      // Match typical SRT timecode line:
      // 00:00:01,000 --> 00:00:04,000
      const timecodeRegex =
        /^\s*\d{1,2}:\d{2}:\d{2}\s*[,.:]\s*\d{1,3}\s*-->\s*\d{1,2}:\d{2}:\d{2}\s*[,.:]\s*\d{1,3}/;

      const filtered = [];

      for (const line of lines) {
        const trimmed = line.trim();

        // Keep a single blank line as paragraph separator
        if (trimmed === "") {
          filtered.push("");
          continue;
        }

        // Remove pure numeric index lines
        if (/^\d+$/.test(trimmed)) {
          continue;
        }

        // Remove timecode lines
        if (timecodeRegex.test(trimmed)) {
          continue;
        }

        // Keep everything else (dialogue, tags, etc.)
        filtered.push(line);
      }

      // Collapse multiple blank lines into a single blank line
      const collapsed = [];
      let previousWasBlank = false;

      for (const line of filtered) {
        const isBlank = line.trim() === "";
        if (isBlank && previousWasBlank) {
          continue;
        }
        collapsed.push(line);
        previousWasBlank = isBlank;
      }

      return collapsed.join("\n").trim();
    }

    // NEW: remove blank lines, keep one line under one line
function mergeIntoParagraphs(text) {
  if (!text) return "";

  const lines = text.split(/\r?\n/);

  // Drop empty lines, keep everything else as separate lines
  const kept = lines
    .map((l) => l.trim())     // optional: trim spaces around each line
    .filter((l) => l.length); // remove blanks

  return kept.join("\n");      // keep line-by-line structure
}



    const inputEl = document.getElementById("inputSrt");
    const outputEl = document.getElementById("outputText");
    const convertBtn = document.getElementById("convertBtn");
    const copyBtn = document.getElementById("copyBtn");
    const fileInput = document.getElementById("fileInput");
    const statusText = document.getElementById("statusText");
    const mergeToggle = document.getElementById("mergeToggle");
    const modeHint = document.getElementById("modeHint");

    function setStatus(message) {
      statusText.textContent = message || "";
    }

    // Update the hint text when toggle changes
    mergeToggle.addEventListener("change", () => {
      modeHint.textContent = mergeToggle.checked
        ? "merged into paragraphs"
        : "line breaks preserved";
    });

    convertBtn.addEventListener("click", () => {
      const input = inputEl.value;
      let result = stripSrtTimecodes(input);

      if (mergeToggle.checked) {
        result = mergeIntoParagraphs(result);
      }

      outputEl.value = result;
      copyBtn.disabled = !result;

      setStatus(
        result
          ? mergeToggle.checked
            ? "‚úÖ Timecodes removed and merged into paragraphs."
            : "‚úÖ Timecodes removed. Line breaks preserved."
          : "Nothing to convert. Paste SRT content first."
      );
    });

    copyBtn.addEventListener("click", async () => {
      const text = outputEl.value;
      if (!text) return;

      try {
        await navigator.clipboard.writeText(text);
        setStatus("üìã Copied output to clipboard.");
      } catch (err) {
        setStatus("Could not copy automatically. Please copy manually.");
      }
    });

    fileInput.addEventListener("change", (event) => {
      const file = event.target.files && event.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = (e) => {
        inputEl.value = e.target.result || "";
        setStatus(`Loaded file: ${file.name}. Click ‚ÄúStrip timecodes‚Äù.`);
      };
      reader.onerror = () => {
        setStatus("Failed to read file.");
      };
      reader.readAsText(file, "utf-8");
    });
  </script>
</body>
</html>
